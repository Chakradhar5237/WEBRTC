{"ast":null,"code":"var _jsxFileName = \"C:\\\\Project\\\\LMS\\\\lms\\\\src\\\\Pages\\\\Meetings.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useRef, useState } from \"react\";\nimport './Meetings.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport function MeetingRoom() {\n  _s();\n  const localVideoRef = useRef(null);\n  const remoteVideoRef = useRef(null);\n  const [isStarted, setIsStarted] = useState(false);\n  const [peerConnection, setPeerConnection] = useState(null); // Store peer connection\n\n  useEffect(() => {\n    if (!isStarted) return; // Don't run WebRTC setup if the session is not started\n\n    // Create a new peer connection\n    const pc = new RTCPeerConnection({\n      iceServers: [{\n        urls: 'stun:stun.l.google.com:19302'\n      }]\n    });\n    setPeerConnection(pc);\n    const isOfferer = window.confirm(\"Click OK to act as Offerer, Cancel to be Answerer\");\n    pc.ontrack = event => {\n      if (remoteVideoRef.current) {\n        remoteVideoRef.current.srcObject = event.streams[0];\n      }\n    };\n    async function startWebRTC() {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: true,\n          audio: true\n        });\n        if (localVideoRef.current) {\n          localVideoRef.current.srcObject = stream;\n        }\n        stream.getTracks().forEach(track => pc.addTrack(track, stream));\n        if (isOfferer) {\n          const offer = await pc.createOffer();\n          await pc.setLocalDescription(offer);\n          await fetch('http://3.111.47.203:8080/offer', {\n            method: 'POST',\n            body: JSON.stringify(pc.localDescription),\n            headers: {\n              'Content-Type': 'application/json'\n            }\n          });\n          let answer = null;\n          while (!answer || !answer.type) {\n            const res = await fetch('http://3.111.47.203:8080/answer');\n            answer = await res.json();\n            if (!answer || !answer.type) {\n              console.log(\"Waiting for answer...\");\n              await new Promise(resolve => setTimeout(resolve, 1000));\n            }\n          }\n          await pc.setRemoteDescription(new RTCSessionDescription(answer));\n        } else {\n          const res = await fetch('http://3.111.47.203:8080/offer');\n          const offer = await res.json();\n          if (!offer || !offer.type) {\n            alert(\"Offer not available yet. Please try again.\");\n            return;\n          }\n          await pc.setRemoteDescription(new RTCSessionDescription(offer));\n          const answer = await pc.createAnswer();\n          await pc.setLocalDescription(answer);\n          await fetch('http://3.111.47.203:8080/answer', {\n            method: 'POST',\n            body: JSON.stringify(pc.localDescription),\n            headers: {\n              'Content-Type': 'application/json'\n            }\n          });\n        }\n      } catch (error) {\n        console.error(\"Error accessing media devices or signaling:\", error);\n        alert(\"Could not access camera/microphone or signaling failed: \" + error.message);\n      }\n    }\n    startWebRTC();\n    return () => {\n      // Clean up the peer connection when stopping or unmounting\n      if (pc) {\n        pc.close();\n      }\n    };\n  }, [isStarted]);\n  const handleSessionToggle = () => {\n    if (isStarted) {\n      // Stop the session by closing peer connection\n      setIsStarted(false);\n      if (peerConnection) {\n        peerConnection.close();\n        setPeerConnection(null);\n      }\n    } else {\n      // Start the session\n      setIsStarted(true);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"meeting-room-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-3xl font-bold mb-4 text-blue-700\",\n      children: \"WebRTC Meeting Room\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-gray-600 mb-6\",\n      children: \"Start a peer-to-peer video session using WebRTC\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"meeting-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"video-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold mb-2 text-gray-700\",\n          children: \"Local Video\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n          ref: localVideoRef,\n          autoPlay: true,\n          muted: true,\n          className: \"video-player\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"video-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold mb-2 text-gray-700\",\n          children: \"Remote Video\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n          ref: remoteVideoRef,\n          autoPlay: true,\n          className: \"video-player\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleSessionToggle,\n      className: \"start-btn\",\n      children: isStarted ? \"Stop Session\" : \"Start Session\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 106,\n    columnNumber: 5\n  }, this);\n}\n_s(MeetingRoom, \"5J98k1iwOxNwU9xfW1KqmDlxNJg=\");\n_c = MeetingRoom;\nvar _c;\n$RefreshReg$(_c, \"MeetingRoom\");","map":{"version":3,"names":["useEffect","useRef","useState","jsxDEV","_jsxDEV","MeetingRoom","_s","localVideoRef","remoteVideoRef","isStarted","setIsStarted","peerConnection","setPeerConnection","pc","RTCPeerConnection","iceServers","urls","isOfferer","window","confirm","ontrack","event","current","srcObject","streams","startWebRTC","stream","navigator","mediaDevices","getUserMedia","video","audio","getTracks","forEach","track","addTrack","offer","createOffer","setLocalDescription","fetch","method","body","JSON","stringify","localDescription","headers","answer","type","res","json","console","log","Promise","resolve","setTimeout","setRemoteDescription","RTCSessionDescription","alert","createAnswer","error","message","close","handleSessionToggle","className","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","autoPlay","muted","onClick","_c","$RefreshReg$"],"sources":["C:/Project/LMS/lms/src/Pages/Meetings.js"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\r\nimport './Meetings.css';\r\n\r\nexport function MeetingRoom() {\r\n  const localVideoRef = useRef(null);\r\n  const remoteVideoRef = useRef(null);\r\n  const [isStarted, setIsStarted] = useState(false);\r\n  const [peerConnection, setPeerConnection] = useState(null);  // Store peer connection\r\n\r\n  useEffect(() => {\r\n    if (!isStarted) return;  // Don't run WebRTC setup if the session is not started\r\n\r\n    // Create a new peer connection\r\n    const pc = new RTCPeerConnection({\r\n      iceServers: [{ urls: 'stun:stun.l.google.com:19302' }]\r\n    });\r\n    setPeerConnection(pc);\r\n\r\n    const isOfferer = window.confirm(\"Click OK to act as Offerer, Cancel to be Answerer\");\r\n\r\n    pc.ontrack = (event) => {\r\n      if (remoteVideoRef.current) {\r\n        remoteVideoRef.current.srcObject = event.streams[0];\r\n      }\r\n    };\r\n\r\n    async function startWebRTC() {\r\n      try {\r\n        const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });\r\n        if (localVideoRef.current) {\r\n          localVideoRef.current.srcObject = stream;\r\n        }\r\n        stream.getTracks().forEach(track => pc.addTrack(track, stream));\r\n\r\n        if (isOfferer) {\r\n          const offer = await pc.createOffer();\r\n          await pc.setLocalDescription(offer);\r\n\r\n          await fetch('http://3.111.47.203:8080/offer', {\r\n            method: 'POST',\r\n            body: JSON.stringify(pc.localDescription),\r\n            headers: { 'Content-Type': 'application/json' }\r\n          });\r\n\r\n          let answer = null;\r\n          while (!answer || !answer.type) {\r\n            const res = await fetch('http://3.111.47.203:8080/answer');\r\n            answer = await res.json();\r\n            if (!answer || !answer.type) {\r\n              console.log(\"Waiting for answer...\");\r\n              await new Promise(resolve => setTimeout(resolve, 1000));\r\n            }\r\n          }\r\n\r\n          await pc.setRemoteDescription(new RTCSessionDescription(answer));\r\n        } else {\r\n          const res = await fetch('http://3.111.47.203:8080/offer');\r\n          const offer = await res.json();\r\n\r\n          if (!offer || !offer.type) {\r\n            alert(\"Offer not available yet. Please try again.\");\r\n            return;\r\n          }\r\n\r\n          await pc.setRemoteDescription(new RTCSessionDescription(offer));\r\n          const answer = await pc.createAnswer();\r\n          await pc.setLocalDescription(answer);\r\n\r\n          await fetch('http://3.111.47.203:8080/answer', {\r\n            method: 'POST',\r\n            body: JSON.stringify(pc.localDescription),\r\n            headers: { 'Content-Type': 'application/json' }\r\n          });\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error accessing media devices or signaling:\", error);\r\n        alert(\"Could not access camera/microphone or signaling failed: \" + error.message);\r\n      }\r\n    }\r\n\r\n    startWebRTC();\r\n\r\n    return () => {\r\n      // Clean up the peer connection when stopping or unmounting\r\n      if (pc) {\r\n        pc.close();\r\n      }\r\n    };\r\n  }, [isStarted]);\r\n\r\n  const handleSessionToggle = () => {\r\n    if (isStarted) {\r\n      // Stop the session by closing peer connection\r\n      setIsStarted(false);\r\n      if (peerConnection) {\r\n        peerConnection.close();\r\n        setPeerConnection(null);\r\n      }\r\n    } else {\r\n      // Start the session\r\n      setIsStarted(true);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"meeting-room-container\">\r\n      <h2 className=\"text-3xl font-bold mb-4 text-blue-700\">WebRTC Meeting Room</h2>\r\n      <p className=\"text-gray-600 mb-6\">Start a peer-to-peer video session using WebRTC</p>\r\n      \r\n      <div className=\"meeting-container\">\r\n        <div className=\"video-container\">\r\n          <h3 className=\"text-lg font-semibold mb-2 text-gray-700\">Local Video</h3>\r\n          <video\r\n            ref={localVideoRef}\r\n            autoPlay\r\n            muted\r\n            className=\"video-player\"\r\n          ></video>\r\n        </div>\r\n        \r\n        <div className=\"video-container\">\r\n          <h3 className=\"text-lg font-semibold mb-2 text-gray-700\">Remote Video</h3>\r\n          <video\r\n            ref={remoteVideoRef}\r\n            autoPlay\r\n            className=\"video-player\"\r\n          ></video>\r\n        </div>\r\n      </div>\r\n\r\n      <button\r\n        onClick={handleSessionToggle}\r\n        className=\"start-btn\"\r\n      >\r\n        {isStarted ? \"Stop Session\" : \"Start Session\"}\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}